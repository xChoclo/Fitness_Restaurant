var ThumbnailPlayer;(function(n){function bt(){k||(k=!0,ft(_w,at,kt,!0))}function kt(){e=[];k=!1}function et(n,t,i,r,u,f,e,o){var s=null,h=!0;switch(n){case VRHEnums.ThumbnailType.ST:s=ThUrlGenerator.NewThumbnailUrl(t,i,u,f,e,ThUrlGenerator.CroppingType.SmartRatio,ThUrlGenerator.ResizeMode.Ratio);r==VRHEnums.HoveredElementType.Adult&&(s+="&m=3");break;case VRHEnums.ThumbnailType.MT:case VRHEnums.ThumbnailType.MMMT:h=!1;s=o;break;default:return null}return nt(s,h)}function dt(n){if(e[n])return e[n].clientHeight}var st="vrhi",ht="vt_vp",ct="vrhtpc",lt="player_ol",at="unload",d="thumbnailplayer",o="undefined",i=typeof pMMUtils!=o?pMMUtils:null,p=typeof SmartEvent!=o?SmartEvent:null,r=typeof VideoRichHoverUtils!=o?VideoRichHoverUtils:null,t=typeof VRHConsts!=o?VRHConsts:null,w=typeof vrhgc!=o?vrhgc:null,s=!1,u=null,g=null,vt=null,nt=null,yt=null,h=null,c=null,l=null,tt=null,pt=null,a=null,it=null,rt=null,b=null,v=null,ut=null,ft=null,f=!1,e=[],k=!1,y,ot;if(!s&&i&&i.gebc&&i.sc&&i.sw&&i.sh&&i.ga&&i.gfbc&&i.st&&i.ac&&i.ss&&t&&r&&r.showElementFromList&&r.showElementTree&&r.getOffsetWithScroll&&p&&p.bind&&(u=i.gfbc,g=i.sepd,vt=i.ga,yt=i.sc,h=i.rc,c=i.sw,l=i.sh,tt=i.ss,pt=i.st,a=i.ac,rt=i.gsh,f=typeof i.isTest=="function"?i.isTest():!1,it=r.showElementFromList,b=r.showElement,v=r.showElementTree,ut=r.getOffsetWithScroll,nt=r.getThumbUrlOrMockThumbUrl,ft=p.bind,s=!0),s&&_w&&!_w[d]){_w[d]=n;function wt(n,t,i,r,u,f,o,h){if(s&&n&&n.length>1){if(!u||!o||!o.thid||!f||f.length<1||!r)return;e[n]&&(e[n]=null);e[n]=new ot(n,t,i,r,u,f,o,h)}return}bt();n.init=wt}n.clientHeight=dt;ot=function(){function n(n,i,r,e,o,s,p,k){var d=this,ft,nt;(this.imageThumbnailId=null,this.smtThumbnailLink=null,this.hoverContainer=null,this.videoPlayer=null,this.imageContainer=null,this.smtContainer=null,this.thumbnailContainer=null,this.playerOverlay=null,this.thumbnailPlayerMeta=null,this.instMeta=null,this.thumbnailClientWidth=0,this.thumbnailClientHeight=0,this.pidStr=null,this.isAdultThumb=!1,this.eventBinded=!1,this.richHoverConfig=null,this.isCanceled=!1,this.playerNameStr=null,this.isThumbnailResized=!1,this.clientHeight=0,this.elementIntialize=function(n,t,i){return(d.isAdultThumb=d.thumbnailPlayerMeta.isAdultThumb,!d.thumbnailPlayerMeta.thid||d.thumbnailPlayerMeta.thid.length<1)?!1:(d.richHoverConfig=n,d.smtThumbnailLink=d.thumbnailPlayerMeta.smtThumbUrl,d.playerNameStr=i,d.thumbnailClientWidth=d.thumbnailPlayerMeta.thumbnailWidth,d.thumbnailClientHeight=d.thumbnailPlayerMeta.thumbnailHeight,d.thumbnailContainer=u(ct,t),d.thumbnailContainer==null)?!1:(sj_be(d.thumbnailContainer,"click",d.onClick),sj_be(d.thumbnailContainer,"mousemove",d.onMouseMove),c(d.thumbnailContainer,d.thumbnailClientWidth),l(d.thumbnailContainer,d.thumbnailClientHeight),d.setPlayerSizeAttribute(),d.pidStr=d.richHoverConfig.pid,d.imageThumbnailId=d.thumbnailPlayerMeta.thid,!0)},this.prepareSMTPlayer=function(){if(d.updatePlayerStatus(VRHEnums.PlayerStatus.None),d.richHoverConfig.fdmtp||typeof VideoRichHoverTestUtils!="undefined"&&VideoRichHoverTestUtils.forceDisableMotionThumbnailPlay)return!1;if(d.smtThumbnailLink){if(d.smtContainer=u(ht,d.thumbnailContainer),!d.smtContainer)return!1;if(d.playerOverlay=u(lt,d.thumbnailContainer),c(d.smtContainer,d.thumbnailClientWidth),l(d.smtContainer,d.thumbnailClientHeight),typeof Html5VideoSMTPlayer!="undefined"&&(d.videoPlayer=Html5VideoSMTPlayer),d.videoPlayer&&d.videoPlayer.init&&d.videoPlayer.init(d.smtContainer,d.playerNameStr,d.thumbnailPlayerMeta,d.instMeta,d.richHoverConfig.enmuteinst))return d.updatePlayerStatus(VRHEnums.PlayerStatus.Loading),y=0,d.eventBind(),!0}return!1},this.eventBind=function(){sj_evt.bind(t.PlayerLoadEvt,d.onVideoLoadding);sj_evt.bind(t.PlayerEndEvt,d.onVideoStop);sj_evt.bind(t.PlayerEndEvtV2,d.onVideoEnd);sj_evt.bind(t.PlayerStartEvt,d.onVideoStart);sj_evt.bind(t.PlayerDownloadEndEvt,d.onVideoDownloadFinish);sj_evt.bind(t.MMSTSeekEvt,d.onVideoSeek);sj_evt.bind(t.FallbackToNonSMTEvt,d.onFallbackToNonSMT);sj_evt.bind(t.PlayerErrEvt,d.onVideoPlayErr);sj_evt.bind(t.HoverCancelEvt,d.onHoverCancel);sj_evt.bind(t.TogglePlayerStatusEvt,d.togglePlayerStatusBetweenPauseAndPlay);sj_evt.bind(t.HoverViewPortUpdateEvt,d.viewPortUpdateListener);f&&sj_evt.bind(t.HoverDisplay,d.onHoverDisplay);d.eventBinded=!0},this.eventUnbind=function(){d.eventBinded&&(sj_evt.unbind(t.PlayerLoadEvt,d.onVideoLoadding),sj_evt.unbind(t.PlayerEndEvt,d.onVideoStop),sj_evt.unbind(t.PlayerStartEvt,d.onVideoStart),sj_evt.unbind(t.PlayerDownloadEndEvt,d.onVideoDownloadFinish),sj_evt.unbind(t.MMSTSeekEvt,d.onVideoSeek),sj_evt.unbind(t.PlayerErrEvt,d.onVideoPlayErr),sj_evt.unbind(t.TogglePlayerStatusEvt,d.togglePlayerStatusBetweenPauseAndPlay),sj_evt.unbind(t.HoverViewPortUpdateEvt,d.viewPortUpdateListener),f&&sj_evt.unbind(t.HoverDisplay,d.onHoverDisplay),d.isThumbnailResized&&(d.isThumbnailResized=!1,h(d.hoverContainer,t.HoverThumbnailOutOfViewPortClassName)),d.eventBinded=!1);sj_evt.unbind(t.HoverContainerDisplayEvt,d.onHoverContainerDisplay)},this.isCallMe=function(n){return d.videoPlayer&&n&&n.length>2&&n[2]===d.playerNameStr},this.onHoverContainerDisplay=function(){if(d.hoverContainer){var n=u(t.HoverStatusMessageContainerClassName,d.hoverContainer);n&&(d.videoPlayerStatus===VRHEnums.PlayerStatus.Playing||d.videoPlayerStatus===VRHEnums.PlayerStatus.Loading?n.innerText=d.richHoverConfig.ppro:n.innerHTML=d.richHoverConfig.npro)}},this.onVideoPlayErr=function(n){d.isCallMe(n)&&(d.updatePlayerStatus(VRHEnums.PlayerStatus.Stopped),d.isCanceled=!1,v(d.smtContainer,!1));sj_evt.fire(t.FallbackToNonSMTEvt)},this.onHoverCancel=function(){d.eventUnbind()},this.onHoverDisplay=function(){f&&console.log("hit hover player")},this.onVideoStart=function(n){if(d.videoPlayerStatus!==VRHEnums.PlayerStatus.Playing&&d.isCallMe(n))if(d.isCanceled)d.onVideoStop(n);else y===0&&(y=sb_st(function(){if((sb_ct(y),d.videoPlayerStatus!==VRHEnums.PlayerStatus.Playing)&&d.videoPlayer&&d.isCanceled){d.onVideoStop(n);return}},20))},this.onVideoSeek=function(n){if(d.videoPlayerStatus===VRHEnums.PlayerStatus.Playing&&n&&!(n.length<3)&&d.videoPlayer&&d.videoPlayer.seekVideo){var t=parseInt(n[2]);isNaN(t)||d.videoPlayer.seekVideo(t)}},this.onVideoLoadding=function(n){d.isCallMe(n)&&d.updatePlayerStatus(VRHEnums.PlayerStatus.Loading)},this.onVideoStop=function(n){d.isCallMe(n)&&(d.updatePlayerStatus(VRHEnums.PlayerStatus.Stopped),d.isCanceled=!1,v(d.smtContainer,!1))},this.onVideoEnd=function(n){d.isCallMe(n)&&d.updatePlayerStatus(VRHEnums.PlayerStatus.Ended)},this.onVideoDownloadFinish=function(){d.smtContainer&&(d.updatePlayerStatus(VRHEnums.PlayerStatus.Playing),v(d.smtContainer,!0),f&&sj_evt.fire(t.HoverDisplay))},this.onFallbackToNonSMT=function(){d.imageContainer&&(b(d.imageContainer,!0),f&&sj_evt.fire(t.HoverDisplay))},this.onThumbnailLoaded=function(){b(d.imageContainer,!0);sj_evt.fire(t.HoverThumbLoadEvt,d.instMeta,d.playerNameStr)},this.onMouseMove=function(n){var t,i,r=(i=(t=d.thumbnailPlayerMeta)===null||t===void 0?void 0:t.eventHandlerMap)===null||i===void 0?void 0:i[VRHEnums.TriggerEvent.PlayerMouseMove];d.invokeEventHandlers(n,r)},this.onClick=function(n){var t,i,r=(i=(t=d.thumbnailPlayerMeta)===null||t===void 0?void 0:t.eventHandlerMap)===null||i===void 0?void 0:i[VRHEnums.TriggerEvent.PlayerClick];d.invokeEventHandlers(n,r)},this.invokeEventHandlers=function(n,i){for(var r=0;r<(i===null||i===void 0?void 0:i.length);r++)switch(i[r]){case VRHEnums.EventHandler.ReplayPlayer:sj_evt.fire(t.PlayerReplayEvt,d.instMeta,d.playerNameStr);d.updatePlayerStatus(VRHEnums.PlayerStatus.Playing);break;case VRHEnums.EventHandler.TogglePlayerPlayAndPause:d.togglePlayerStatusBetweenPauseAndPlay()&&g(n)}},this.togglePlayerStatusBetweenPauseAndPlay=function(){return d.videoPlayerStatus===VRHEnums.PlayerStatus.Paused?(sj_evt.fire(t.PlayerReplayEvt,d.instMeta,d.playerNameStr),d.updatePlayerStatus(VRHEnums.PlayerStatus.Playing),!0):d.videoPlayerStatus===VRHEnums.PlayerStatus.Playing?(sj_evt.fire(t.PlayerPauseEvt,d.instMeta,d.playerNameStr),d.updatePlayerStatus(VRHEnums.PlayerStatus.Paused),!0):!1},this.initializeThumbnailContainer=function(n,t){if(d.imageContainer=u(st,t),!d.imageContainer)return!1;var i=et(VRHEnums.ThumbnailType.ST,d.imageThumbnailId,d.isAdultThumb,d.hoverType,d.thumbnailClientWidth,d.thumbnailClientHeight,d.pidStr,d.smtThumbnailLink);return i==null?!1:(d.thumbnailPlayerMeta.smtThumbUrl&&(d.thumbnailPlayerMeta.smtThumbUrl=et(VRHEnums.ThumbnailType.MT,d.imageThumbnailId,d.isAdultThumb,d.hoverType,d.thumbnailClientWidth,d.thumbnailClientHeight,d.pidStr,d.smtThumbnailLink)),d.thumbnailPlayerMeta.imageThumbUrl=i,d.imageContainer.onload=d.onThumbnailLoaded,d.imageContainer.src=i,d.imageContainer.alt=d.thumbnailPlayerMeta.videoTitle,d.thumbnailPlayerMeta.beginClipIndex>1?tt(d.imageContainer,"margin-left",(1-d.thumbnailPlayerMeta.beginClipIndex)*d.thumbnailClientWidth+"px"):(c(d.imageContainer,d.thumbnailClientWidth),l(d.imageContainer,d.thumbnailClientHeight)),!0)},this.updatePlayerStatus=function(n){var u,i,r;for(u in t.PlayerStatusClassName)i=t.PlayerStatusClassName[u],i&&(h(d.thumbnailContainer,i),h(d.hoverContainer,i));return r=t.PlayerStatusClassName[n],r&&(a(d.thumbnailContainer,r),a(d.hoverContainer,r)),d.videoPlayerStatus=n,!0},this.setPlayerSizeAttribute=function(){var n,i=(n=w===null||w===void 0?void 0:w.psam)!==null&&n!==void 0?n:t.PlayerSizesToAttributes,r=i===null||i===void 0?void 0:i.find(function(n){return d.thumbnailClientWidth>n.w});r&&d.hoverContainer&&d.hoverContainer.setAttribute(t.ThumbnailPlayerSizeAttribute,r.val)},this.viewPortUpdateListener=function(){var n=d.hoverContainer,i=d.thumbnailContainer,r,u;n&&i&&(r=ut(i,n,VRHEnums.ScrollingDirection.Vertical),u=r[1],!d.isThumbnailResized&&u<=-d.thumbnailClientHeight&&(a(n,t.HoverThumbnailOutOfViewPortClassName),d.isThumbnailResized=!0))},!n||n.length<1||!p)||(this.thumbnailPlayerMeta=p,this.hoverType=r,this.hoverContainer=o,sj_evt.bind(t.HoverContainerDisplayEvt,this.onHoverContainerDisplay),k&&(this.instMeta=k),ft=new Array(0),this.elementIntialize(e,o,s))&&this.initializeThumbnailContainer(ft,this.thumbnailContainer)&&(ft.push(this.thumbnailContainer),nt=this.prepareSMTPlayer(ft),nt||sj_evt.fire(VRHConsts.FallbackToNonSMTEvt),ThumbnailPlayerOverlay&&ThumbnailPlayerOverlay.init&&ThumbnailPlayerOverlay.init(n,o,this.playerNameStr,i,r,this.richHoverConfig,this.thumbnailPlayerMeta,k,nt,nt?this.videoPlayer.setVolume:null,nt?this.videoPlayer.setLastStableVolume:null,nt?this.videoPlayer.setMute:null,nt?this.videoPlayer.getVolume:null,nt?this.videoPlayer.isMute:null),it(ft,!0),this.clientHeight=rt(this.thumbnailContainer))}return n}()})(ThumbnailPlayer||(ThumbnailPlayer={}))